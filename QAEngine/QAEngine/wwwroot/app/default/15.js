(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"3yYE":function(e,t,s){"use strict";s.r(t),s.d(t,"ManageAccountModule",(function(){return L}));var r=s("ofXK"),i=s("3Pt+"),o=s("tyNb"),a=s("l7P3"),n=s("pz8m"),c=s("7NWl"),d=s("zwrK"),l=s("LEd3"),h=s("XDFV"),u=s("b6Qw"),p=s("fXoL"),g=s("nD3/"),m=s("RDfn"),b=s("+kG/");function w(e,t){1&e&&p.Lb(0,"app-loader")}function f(e,t){if(1&e){const e=p.Rb();p.Qb(0,"dynamic-modal-form",8),p.bc("OnSubmit",(function(t){return p.uc(e),p.dc().SubmitForm(t)})),p.Pb()}if(2&e){const e=p.dc();p.kc("controls",e.controls)("showLoader",e.showLoader)("showCancel",!1)("showModal",!1)("submitText",e.submitText)}}let y=(()=>{class e{constructor(e,t,s,r,i,o,n){this._store=e,this.settingService=t,this.dataService=s,this.coreService=r,this.formService=i,this.router=o,this.cookieService=n,this.controls=[],this.showLoader=!0,this.submitText="Save Changes",this.User={},this.auth$=this._store.pipe(Object(a.n)(h.a))}ngOnInit(){this.auth$.subscribe(e=>{this.User=e.User,this.initializeControls(e.User),this.showLoader=!1})}initializeControls(e){this.controls=this.formService.getControls(e,4,!1)}deleteAccount(){!0===confirm("Are you sure you want to delete your account?")&&this.dataService.DeleteAccount(this.User).subscribe(e=>{"error"===e.status?this._store.dispatch(new l.c({title:e.message,text:"",css:"bg-danger"})):(this._store.dispatch(new l.c({title:"Account Deleted",text:"",css:"bg-success"})),this.router.navigate(["/"])),this.showLoader=!1},e=>{this.showLoader=!1,this._store.dispatch(new l.c({title:"Error Occured",text:"",css:"bg-danger"}))})}SubmitForm(e){this.User.cpassword=e.cpassword,this.User.opassword=e.opassword,this.User.password=e.password,this.User.viewType=4,this.User.password===this.User.cpassword?(this.User.isadmin=!1,this.showLoader=!0,this.dataService.AddRecord(this.User).subscribe(e=>{"error"===e.status?this._store.dispatch(new l.c({title:e.message,text:"",css:"bg-danger"})):(this._store.dispatch(new l.c({title:"Password changed successfully",text:"",css:"bg-success"})),this.router.navigate(["/"])),this.showLoader=!1},e=>{this.showLoader=!1,this._store.dispatch(new l.c({title:"Error Occured",text:"",css:"bg-danger"}))})):this._store.dispatch(new l.c({title:"Password not matched",text:"",css:"bg-danger"}))}}return e.\u0275fac=function(t){return new(t||e)(p.Kb(a.h),p.Kb(d.a),p.Kb(c.a),p.Kb(g.a),p.Kb(n.a),p.Kb(o.f),p.Kb(u.a))},e.\u0275cmp=p.Eb({type:e,selectors:[["app-manageaccount"]],features:[p.wb([c.a,d.a,n.a,u.a])],decls:11,vars:2,consts:[[1,"dashborad-box"],[1,"title"],[1,"row"],[1,"col-md-6","col-xs-12"],[4,"ngIf"],[3,"controls","showLoader","showCancel","showModal","submitText","OnSubmit",4,"ngIf"],[1,"section-body","text-center"],[1,"btn","btn-danger",3,"click"],[3,"controls","showLoader","showCancel","showModal","submitText","OnSubmit"]],template:function(e,t){1&e&&(p.Qb(0,"div",0),p.Qb(1,"h4",1),p.Fc(2,"Change Password"),p.Pb(),p.Qb(3,"div",2),p.Qb(4,"div",3),p.Dc(5,w,1,0,"app-loader",4),p.Dc(6,f,1,5,"dynamic-modal-form",5),p.Pb(),p.Pb(),p.Pb(),p.Qb(7,"div",0),p.Qb(8,"div",6),p.Qb(9,"button",7),p.bc("click",(function(){return t.deleteAccount()})),p.Fc(10," Delete Account "),p.Pb(),p.Pb(),p.Pb()),2&e&&(p.xb(5),p.kc("ngIf",t.showLoader),p.xb(1),p.kc("ngIf",!t.showLoader&&t.controls.length>0))},directives:[r.u,m.a,b.a],encapsulation:2}),e})();var v=s("o+qO"),_=s("/4iV");const S=[{path:"",data:{topmenuIndex:_.c.TOPMENU_SETTINGS_INDEX,leftmenuIndex:_.c.SETTINGS_MANAGE_ACCOUNT_INDEX,title:"My Account",urls:[{title:"My Account",url:"/"},{title:"Manage Account"}]},component:y}];let L=(()=>{class e{}return e.\u0275mod=p.Ib({type:e}),e.\u0275inj=p.Hb({factory:function(t){return new(t||e)},imports:[[i.l,r.c,v.a,o.j.forChild(S)]]}),e})()},"7NWl":function(e,t,s){"use strict";s.d(t,"a",(function(){return h}));var r=s("5zJ1"),i=s("UIv2"),o=s("LEd3"),a=s("fXoL"),n=s("l7P3"),c=s("zwrK"),d=s("tk/3"),l=s("nD3/");let h=(()=>{class e{constructor(e,t,s,r){this._store=e,this.settings=t,this.http=s,this.coreService=r}LoadRecords(e){const t=this.settings.getApiOptions().load;this._store.dispatch(new r.j({})),this.http.post(t,JSON.stringify(e)).subscribe(t=>{this.coreService.attachEncryptedId(t.posts),this._store.dispatch(new r.k(t)),this._store.dispatch(new o.d({totalrecords:t.records,pagesize:e.pagesize,pagenumber:e.pagenumber}))},e=>{this._store.dispatch(new r.i(e))})}LoadSmListReducer(e){const t=this.settings.getApiOptions().load;this._store.dispatch(new i.u({})),this.http.post(t,JSON.stringify(e)).subscribe(e=>{this.coreService.attachEncryptedId(e.posts),this._store.dispatch(new i.v(e))},e=>{this._store.dispatch(new i.q(e))})}GenerateSummaryReport(e){const t=this.settings.getApiOptions().generate_report;this._store.dispatch(new i.s({})),this.http.post(t,JSON.stringify(e)).subscribe(e=>{let t=this.coreService.initializeChartData(e.data.dataTable,e.data.chartType);this._store.dispatch(new i.t(t))},e=>{this._store.dispatch(new i.r(e))})}AddRecord(e){let t="";switch(e.viewType){case 1:case 2:t=this.settings.getApiOptions().proc;break;case 3:t=this.settings.getApiOptions().cemail;break;case 4:t=this.settings.getApiOptions().chpass;break;case 5:t=this.settings.getApiOptions().ctype}return 2===e.viewType?(e.settings.userid=e.id,e.account.userid=e.id,this.http.post(t,JSON.stringify({id:e.id,firstname:e.firstname,lastname:e.lastname,mobile:e.mobile,phoneNumber:e.phoneNumber,attr_values:e.attr_values,settings:e.settings,account:e.account,isadmin:!0}))):this.http.post(t,JSON.stringify(e))}UpdateThumb(e,t){const s=this.settings.getApiOptions().updatethumb,i={};i.Id=e.id;for(const r of t)i.picturename=r.fname;this.http.post(s,JSON.stringify(i)).subscribe(e=>{"error"===e.status?this._store.dispatch(new o.c({title:e.message,text:"",css:"bg-danger"})):(this._store.dispatch(new r.c(e.record)),this._store.dispatch(new o.c({title:"Photo updated successfully",text:"",css:"bg-success"})))},e=>{this._store.dispatch(new o.c({title:e,text:"",css:"bg-danger"}))})}UpdateAvator(e){const t=this.settings.getApiOptions().updateavator;this.http.post(t,JSON.stringify(e)).subscribe(e=>{"error"===e.status?this._store.dispatch(new o.c({title:e.message,text:"",css:"bg-danger"})):(this._store.dispatch(new r.c(e.record)),this._store.dispatch(new o.c({title:"Photo updated successfully",text:"",css:"bg-success"})))},e=>{this._store.dispatch(new o.c({title:e,text:"",css:"bg-danger"}))})}GetInfo(e){const t=this.settings.getApiOptions().getinfo;return this.http.post(t,JSON.stringify({id:e}))}LoadReports(e){return this.http.post(this.settings.getApiOptions().load_reports,JSON.stringify(e))}Authenticate(e){const t=this.settings.getApiOptions().authenticate;return this.http.post(t,JSON.stringify(e))}UpdateRole(e){const t=this.settings.getApiOptions().updaterole;return this.http.post(t,JSON.stringify(e))}GetUserLog(e){const t=this.settings.getApiOptions().userlog;return this.http.post(t,JSON.stringify({userid:e}))}DeleteAccount(e){const t=this.settings.getApiOptions().archive;return this.http.post(t,JSON.stringify(e))}DeleteRecord(e,t){e.actionstatus="delete";const s=[];s.push(e),this.ProcessActions(s,"delete")}ProcessActions(e,t){this._store.dispatch(new r.g({SelectedItems:e,isenabled:t}));const s=[];for(const r of e)s.push({id:r.id,actionstatus:r.actionstatus});this.http.post(this.settings.getApiOptions().action,JSON.stringify(s)).subscribe(e=>{let s="Operation Performed";"delete"===t&&(s="Record Removed"),this._store.dispatch(new o.c({title:s,text:"",css:"bg-success"}))},e=>{this._store.dispatch(new o.c({title:"Error Occured",text:"",css:"bg-danger"}))})}ProcessLogActions(e,t){this._store.dispatch(new o.c({title:"Feature not yet implemented",text:"",css:"bg-success"}))}}return e.\u0275fac=function(t){return new(t||e)(a.Yb(n.h),a.Yb(c.a),a.Yb(d.b),a.Yb(l.a))},e.\u0275prov=a.Gb({token:e,factory:e.\u0275fac}),e})()},pz8m:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var r=s("dNLF"),i=s("/4iV"),o=s("fXoL"),a=s("nD3/");let n=(()=>{class e{constructor(e){this.coreService=e}getControls(e,t,s=!0){switch(t){case 1:return this.CreateAccountControls(e);case 2:return this.EditProfileControls(e,s);case 3:return this.ChangeEmailControls(e,s);case 4:return this.ChangePasswordControls(e,s);case 5:return this.ChangeUserTypeControls(e)}return this.CreateAccountControls(e)}CreateAccountControls(e){const t=[],s=[];for(const r of i.b.USER_TYPES)s.push({key:r.value,value:r.title});return t.push(new r.b({key:"role_name",label:"Select Role",value:e.role_name.toString(),options:s,order:0})),t.push(new r.i({key:"firstname",label:"",value:e.firstname,placeholder:"First Name",minLength:3,maxLength:50,order:1})),t.push(new r.i({key:"lastname",label:"",value:e.lastname,placeholder:"Last Name",minLength:3,maxLength:50,order:2})),t.push(new r.i({key:"username",label:"",value:e.username,placeholder:"User Name",minLength:5,maxLength:15,required:!0,pattern:i.d.USERNAME_REGEX,order:3})),t.push(new r.i({key:"password",type:"password",label:"",value:e.password,placeholder:"Password",minLength:5,maxLength:20,required:!0,pattern:i.d.PASSWORD_REGEX,order:4})),t.push(new r.i({key:"cpassword",type:"password",label:"",placeholder:"Confirm Password",value:e.cpassword,minLength:5,maxLength:20,required:!0,order:5})),t.push(new r.i({key:"email",label:"",placeholder:"Email",value:e.email,required:!0,email:!0,order:6})),t.sort((e,t)=>e.order-t.order)}getLoginControls(e){const t=[];return t.push(new r.i({key:"username",label:"",value:e.username,placeholder:"User Name",required:!0,minLength:5,maxLength:20,order:1})),t.push(new r.i({key:"password",type:"password",label:"",value:e.password,placeholder:"Password",required:!0,minLength:5,maxLength:20,order:2})),t.push(new r.a({key:"rememberme",label:"Remember Me",value:e.rememberme,checked:e.rememberme,required:!0,order:3})),t.sort((e,t)=>e.order-t.order)}EditProfileControls(e,t=!0){const s=[];s.push(new r.i({key:"firstname",label:"First Name",value:e.firstname,placeholder:"First Name",minLength:3,maxLength:50,order:0})),s.push(new r.i({key:"lastname",label:"Last Name",value:e.lastname,placeholder:"Last Name",minLength:3,maxLength:50,order:1})),s.push(new r.i({key:"phone",label:"Phone No",value:e.phoneNumber,placeholder:"Enter Phone Number",minLength:3,maxLength:50,order:2})),s.push(new r.i({key:"mobile",label:"Mobile",value:e.mobile,placeholder:"Enter Mobile Number",minLength:3,maxLength:50,order:3}));let i=!1;if(""!==e.id&&(i=!0),this.coreService.renderDynamicControls(s,e.options,i),t){s.push(new r.g({key:"config_section_01",label:"Settings",order:1001}));let t=!1;1===e.settings.isemail&&(t=!0),s.push(new r.a({key:"isemail",label:"Receiving Emails",value:e.settings.isemail,checked:t,helpblock:"Toggle on | off receiving emails",order:1002}));let i=!1;1===e.settings.issendmessages&&(i=!0),s.push(new r.a({key:"issendmessages",label:"Receiving Messages",value:e.settings.issendmessages,checked:i,helpblock:"Toggle on | off receiving internal messages within website",order:1003})),s.push(new r.g({key:"config_section_01",label:"Account",order:1004})),s.push(new r.i({key:"basic_credits",label:"Basic Credits",value:e.account.basic_credits.toString(),colsize:"col-md-12",pattern:"[0-9]+",required:!0,helpblock:"Update user basic credits manually",order:1005})),s.push(new r.i({key:"featured_credits",label:"Featured Credits",value:e.account.featured_credits.toString(),colsize:"col-md-12",pattern:"[0-9]+",required:!0,helpblock:"Update user featured credits manually",order:1006})),s.push(new r.i({key:"premium_credits",label:"Premium Credits",value:e.account.premium_credits.toString(),colsize:"col-md-12",pattern:"[0-9]+",required:!0,helpblock:"Update user premium credits manually",order:1007})),s.push(new r.i({key:"hot_credits",label:"Hot Credits",value:e.account.hot_credits.toString(),colsize:"col-md-12",pattern:"[0-9]+",required:!0,helpblock:"Update user hot credits manually",order:1008})),s.push(new r.i({key:"super_hot_credits",label:"Super Hot Credits",value:e.account.super_hot_credits.toString(),colsize:"col-md-12",pattern:"[0-9]+",required:!0,helpblock:"Update user super hot credits manually",order:1009}))}return s.sort((e,t)=>e.order-t.order)}ChangeEmailControls(e,t=!0){const s=[];return s.push(new r.i({key:"email",label:"Email Address",placeholder:"Email",value:e.email,required:!0,email:!0,order:0})),t||s.push(new r.i({key:"password",type:"password",pattern:i.d.PASSWORD_REGEX,label:"",placeholder:"Password",value:e.password,minLength:5,maxLength:20,required:!0,order:1})),s.sort((e,t)=>e.order-t.order)}ChangePasswordControls(e,t=!0){const s=[];return t||s.push(new r.i({key:"opassword",type:"password",label:"Current Password",value:e.opassword,placeholder:"Old Password",minLength:5,maxLength:20,required:!0,order:0})),s.push(new r.i({key:"password",type:"password",label:"New Password",value:e.password,placeholder:"Password",minLength:5,maxLength:20,required:!0,pattern:i.d.PASSWORD_REGEX,order:4})),s.push(new r.i({key:"cpassword",type:"password",label:"Confirm Password",placeholder:"Confirm Password",value:e.cpassword,minLength:5,maxLength:20,required:!0,order:5})),s.sort((e,t)=>e.order-t.order)}ChangeUserTypeControls(e){const t=[],s=[];for(const r of i.b.USER_TYPES)s.push({key:r.value,value:r.title});return t.push(new r.b({key:"role_name",label:"Select Role",value:e.role_name,options:s,order:0})),t.sort((e,t)=>e.order-t.order)}}return e.\u0275fac=function(t){return new(t||e)(o.Yb(a.a))},e.\u0275prov=o.Gb({token:e,factory:e.\u0275fac}),e})()}}]);