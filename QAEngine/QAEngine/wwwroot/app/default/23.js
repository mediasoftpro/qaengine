(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{vPjw:function(t,e,s){"use strict";s.r(e),s.d(e,"SetupModule",(function(){return j}));var i=s("ofXK"),n=s("3Pt+"),o=s("tyNb"),r=s("fXoL"),c=s("1pjZ"),a=s("l7P3"),p=s("rahX"),d=s("LEd3"),b=s("noRM"),h=s("aRip"),u=s("nD3/"),l=s("Pfcf"),f=s("RDfn"),m=s("+kG/");function g(t,e){1&t&&r.Lb(0,"app-loader")}function S(t,e){1&t&&(r.Qb(0,"h1"),r.Fc(1,"Database Setup"),r.Pb())}function y(t,e){1&t&&(r.Qb(0,"h1"),r.Fc(1,"Website Setup"),r.Pb())}function v(t,e){if(1&t&&(r.Qb(0,"div",10),r.Qb(1,"h2"),r.Fc(2),r.Pb(),r.Lb(3,"hr"),r.Pb()),2&t){const t=r.dc(2);r.xb(2),r.Gc(t.formHeading)}}function x(t,e){1&t&&r.Lb(0,"app-loader")}function P(t,e){if(1&t){const t=r.Rb();r.Qb(0,"dynamic-modal-form",13),r.bc("OnSubmit",(function(e){return r.uc(t),r.dc(3).SubmitForm(e)}))("OnSkip",(function(e){return r.uc(t),r.dc(3).SkipForm(e)})),r.Pb()}if(2&t){const t=r.dc(3);r.kc("controls",t.controls)("showCancel",!1)("skipBtnText",t.skipBtnText)("showModal",!1)("submitText",t.submitText)}}function _(t,e){if(1&t&&(r.Qb(0,"div"),r.Qb(1,"div",11),r.Dc(2,x,1,0,"app-loader",5),r.Dc(3,P,1,5,"dynamic-modal-form",12),r.Pb(),r.Pb()),2&t){const t=r.dc(2);r.xb(2),r.kc("ngIf",t.showProcessing),r.xb(1),r.kc("ngIf",!t.showProcessing&&t.controls.length>0)}}function w(t,e){1&t&&(r.Qb(0,"div"),r.Qb(1,"h4",14),r.Fc(2,"Database connection configured"),r.Pb(),r.Qb(3,"p",8),r.Fc(4," You need to restart your application to start database tables, user setup and other configurations "),r.Pb(),r.Pb())}function T(t,e){1&t&&(r.Qb(0,"div"),r.Qb(1,"h4",15),r.Fc(2," Setup completed. Please restart and use your application. "),r.Pb(),r.Pb())}function k(t,e){if(1&t&&(r.Qb(0,"div"),r.Dc(1,w,5,0,"div",5),r.Dc(2,T,3,0,"div",5),r.Pb()),2&t){const t=r.dc(2);r.xb(1),r.kc("ngIf",0===t.SetupType),r.xb(1),r.kc("ngIf",1===t.SetupType)}}function I(t,e){if(1&t&&(r.Qb(0,"div"),r.Qb(1,"div",6),r.Dc(2,S,2,0,"h1",5),r.Dc(3,y,2,0,"h1",5),r.Lb(4,"hr"),r.Pb(),r.Dc(5,v,4,1,"div",7),r.Dc(6,_,4,2,"div",5),r.Dc(7,k,3,2,"div",5),r.Qb(8,"div",8),r.Qb(9,"p"),r.Fc(10," Note: Setup process only handles core configurations, for specific contents related or detail configuration management, please go to control panel -> settings -> configurations page. "),r.Pb(),r.Qb(11,"p",9),r.Fc(12," Warning: Please remove setup or installation page from from deployed application "),r.Pb(),r.Pb(),r.Pb()),2&t){const t=r.dc();r.xb(2),r.kc("ngIf",0===t.SetupType),r.xb(1),r.kc("ngIf",1===t.SetupType),r.xb(2),r.kc("ngIf",1===t.SetupType&&!t.finalstep),r.xb(1),r.kc("ngIf",!t.finalstep),r.xb(1),r.kc("ngIf",t.finalstep)}}let Q=(()=>{class t{constructor(t,e,s,i,n){this._store=t,this.settingService=e,this.dataService=s,this.coreService=i,this.formService=n,this.Configurations$=this._store.pipe(Object(a.n)(p.a)),this.loading$=this._store.pipe(Object(a.n)(p.c)),this.isloaded$=this._store.pipe(Object(a.n)(p.b)),this.SetupType=0,this.Configs=[],this.Configurations={},this.formHeading="",this.submitText="Next",this.skipBtnText="",this.primay_prop="",this.child_prop="",this.controls=[],this.showProcessing=!1,this.finalstep=!1,this.primary_prop_steps=["general","general","general","general","general","general","general","general","general","general","classified","classified"],this.child_prop_steps=["dbusersetup","general","features","authentication","registration","rechapcha","aws","social","contact","smtp","general","aws"],this.stepIndex=0}ngOnInit(){0===this.SetupType&&(this.submitText="Save Changes"),this.isloaded$.subscribe(t=>{t||this.loadRecords()}),this.Configurations$.subscribe(t=>{this.Configurations=t,0===this.SetupType?this.renderForm("general","dbsetup"):this.renderForm(this.primary_prop_steps[this.stepIndex],this.child_prop_steps[this.stepIndex])})}loadRecords(){this.dataService.LoadRecords()}renderForm(t,e){let s={};this.formHeading="",this.primay_prop=t,this.child_prop=e,this.formHeading=e[0].toUpperCase()+e.slice(1)+" Settings","classified"===t&&(this.formHeading="[Classified] "+this.formHeading),"dbsetup"===e?s={host:"",database:"",userid:"",password:""}:"dbusersetup"===e?(this.formHeading="Create Admin User",s={username:"",email:"",firstname:"",lastname:"",password:""}):s=this.Configurations[t][e],this.controls=this.formService.getControls(s,t,e,!0)}SubmitForm(t){let e=t;if("dbsetup"!==this.child_prop&&"dbusersetup"!==this.child_prop)for(const s in e)for(const i in t)i===s&&(e[s]=t[i]);this.showProcessing=!0,this.dataService.UpdateConfigurations(e,this.primay_prop,this.child_prop).subscribe(t=>{this._store.dispatch(new d.c("error"===t.status?{title:t.message,text:"",css:"bg-danger"}:{title:"Settings Updated",text:"",css:"bg-success"})),this.showProcessing=!1,1===this.SetupType?this._nextForm():this.finalstep=!0},t=>{this._store.dispatch(new d.c({title:"Error Occured",text:"",css:"bg-danger"})),this.showProcessing=!1})}SkipForm(t){this._nextForm()}_nextForm(){this.stepIndex<this.child_prop_steps.length-1?(this.stepIndex++,this.renderForm(this.primary_prop_steps[this.stepIndex],this.child_prop_steps[this.stepIndex])):(this.finalstep=!0,this.dataService.SetupCompleted())}}return t.\u0275fac=function(e){return new(e||t)(r.Kb(a.h),r.Kb(b.a),r.Kb(h.a),r.Kb(u.a),r.Kb(l.a))},t.\u0275cmp=r.Eb({type:t,selectors:[["app-setup"]],inputs:{SetupType:"SetupType"},decls:9,vars:6,consts:[[1,"container","setup-container"],[1,"row","justify-content-md-center"],[1,"col-md-8","col-sm-12"],[1,"card"],[1,"card-body"],[4,"ngIf"],[1,"m-b-20","text-center"],["class","m-b-0 m-l-10",4,"ngIf"],[1,"m-b-20"],[1,"red"],[1,"m-b-0","m-l-10"],[1,"m-b-20","m-t-0"],[3,"controls","showCancel","skipBtnText","showModal","submitText","OnSubmit","OnSkip",4,"ngIf"],[3,"controls","showCancel","skipBtnText","showModal","submitText","OnSubmit","OnSkip"],[1,"m-t-20","m-b-5"],[1,"m-t-20","m-b-20"]],template:function(t,e){1&t&&(r.Qb(0,"div",0),r.Qb(1,"div",1),r.Qb(2,"div",2),r.Qb(3,"div",3),r.Qb(4,"div",4),r.Dc(5,g,1,0,"app-loader",5),r.ec(6,"async"),r.Dc(7,I,13,5,"div",5),r.ec(8,"async"),r.Pb(),r.Pb(),r.Pb(),r.Pb(),r.Pb()),2&t&&(r.xb(5),r.kc("ngIf",r.fc(6,2,e.loading$)),r.xb(2),r.kc("ngIf",!r.fc(8,4,e.loading$)))},directives:[i.u,f.a,m.a],pipes:[i.b],encapsulation:2}),t})(),F=(()=>{class t{constructor(t){this.config=t,this.SetupType=0,this.SetupType=parseInt(this.config.getGlobalVar("setuptype"),10)}}return t.\u0275fac=function(e){return new(e||t)(r.Kb(c.a))},t.\u0275cmp=r.Eb({type:t,selectors:[["ng-component"]],decls:1,vars:1,consts:[[3,"SetupType"]],template:function(t,e){1&t&&r.Lb(0,"app-setup",0),2&t&&r.kc("SetupType",e.SetupType)},directives:[Q],encapsulation:2}),t})();var C=s("o+qO");let D=(()=>{class t{}return t.\u0275mod=r.Ib({type:t}),t.\u0275inj=r.Hb({factory:function(e){return new(e||t)},providers:[b.a,h.a,l.a,u.a],imports:[[i.c,C.a,o.j,n.l,n.A]]}),t})();const O=[{path:"",data:{title:"Setup Application",urls:[{title:"Setup Application"}]},component:F}];let j=(()=>{class t{}return t.\u0275mod=r.Ib({type:t}),t.\u0275inj=r.Hb({factory:function(e){return new(e||t)},imports:[[n.l,i.c,C.a,o.j.forChild(O),D]]}),t})()}}]);