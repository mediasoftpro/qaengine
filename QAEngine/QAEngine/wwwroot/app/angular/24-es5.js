function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{vPjw:function(e,t,i){"use strict";i.r(t);var n=i("ofXK"),s=i("3Pt+"),o=i("tyNb"),a=i("fXoL"),r=i("1pjZ"),c=i("mrSG"),p=i("Usal"),u=i("noRM"),l=i("aRip"),b=i("nD3/"),d=i("LEd3"),f=i("nT4z"),h=i("Pfcf"),g=i("RDfn"),m=i("+kG/");function S(e,t){1&e&&a.Nb(0,"app-loader")}function v(e,t){1&e&&(a.Sb(0,"h1"),a.Gc(1,"Database Setup"),a.Rb())}function y(e,t){1&e&&(a.Sb(0,"h1"),a.Gc(1,"Website Setup"),a.Rb())}function _(e,t){if(1&e&&(a.Sb(0,"div",10),a.Sb(1,"h2"),a.Gc(2),a.Rb(),a.Nb(3,"hr"),a.Rb()),2&e){var i=a.gc(2);a.zb(2),a.Hc(i.formHeading)}}function w(e,t){1&e&&a.Nb(0,"app-loader")}function T(e,t){if(1&e){var i=a.Tb();a.Sb(0,"dynamic-modal-form",13),a.ec("OnSubmit",(function(e){return a.xc(i),a.gc(3).SubmitForm(e)}))("OnSkip",(function(e){return a.xc(i),a.gc(3).SkipForm(e)})),a.Rb()}if(2&e){var n=a.gc(3);a.nc("controls",n.controls)("showCancel",!1)("skipBtnText",n.skipBtnText)("showModal",!1)("submitText",n.submitText)}}function C(e,t){if(1&e&&(a.Sb(0,"div"),a.Sb(1,"div",11),a.Ec(2,w,1,0,"app-loader",5),a.Ec(3,T,1,5,"dynamic-modal-form",12),a.Rb(),a.Rb()),2&e){var i=a.gc(2);a.zb(2),a.nc("ngIf",i.showProcessing),a.zb(1),a.nc("ngIf",!i.showProcessing&&i.controls.length>0)}}function R(e,t){1&e&&(a.Sb(0,"div"),a.Sb(1,"h4",14),a.Gc(2,"Database connection configured"),a.Rb(),a.Sb(3,"p",8),a.Gc(4," You need to restart your application to start database tables, user setup and other configurations "),a.Rb(),a.Rb())}function x(e,t){1&e&&(a.Sb(0,"div"),a.Sb(1,"h4",15),a.Gc(2," Setup completed. Please restart and use your application. "),a.Rb(),a.Rb())}function k(e,t){if(1&e&&(a.Sb(0,"div"),a.Ec(1,R,5,0,"div",5),a.Ec(2,x,3,0,"div",5),a.Rb()),2&e){var i=a.gc(2);a.zb(1),a.nc("ngIf",0===i.SetupType),a.zb(1),a.nc("ngIf",1===i.SetupType)}}function I(e,t){if(1&e&&(a.Sb(0,"div"),a.Sb(1,"div",6),a.Ec(2,v,2,0,"h1",5),a.Ec(3,y,2,0,"h1",5),a.Nb(4,"hr"),a.Rb(),a.Ec(5,_,4,1,"div",7),a.Ec(6,C,4,2,"div",5),a.Ec(7,k,3,2,"div",5),a.Sb(8,"div",8),a.Sb(9,"p"),a.Gc(10," Note: Setup process only handles core configurations, for specific contents related or detail configuration management, please go to control panel -> settings -> configurations page. "),a.Rb(),a.Sb(11,"p",9),a.Gc(12," Warning: Please remove setup or installation page from from deployed application "),a.Rb(),a.Rb(),a.Rb()),2&e){var i=a.gc();a.zb(2),a.nc("ngIf",0===i.SetupType),a.zb(1),a.nc("ngIf",1===i.SetupType),a.zb(2),a.nc("ngIf",1===i.SetupType&&!i.finalstep),a.zb(1),a.nc("ngIf",!i.finalstep),a.zb(1),a.nc("ngIf",i.finalstep)}}var O,P,E,z=((P=function(){function e(t,i,n,s,o,a){_classCallCheck(this,e),this.settingService=t,this.dataService=i,this.coreService=n,this.coreActions=s,this.actions=o,this.formService=a,this.SetupType=0,this.Configs=[],this.Configurations={},this.formHeading="",this.submitText="Next",this.skipBtnText="",this.primay_prop="",this.child_prop="",this.controls=[],this.showProcessing=!1,this.finalstep=!1,this.primary_prop_steps=["general","general","general","general","general","general","general","general","general","general","qa"],this.child_prop_steps=["dbusersetup","general","features","authentication","registration","rechapcha","aws","social","contact","smtp","general"],this.stepIndex=0}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;0===this.SetupType&&(this.submitText="Save Changes"),this.isloaded$.subscribe((function(t){t||e.loadRecords()})),this.Configurations$.subscribe((function(t){e.Configurations=t,0===e.SetupType?e.renderForm("general","dbsetup"):e.renderForm(e.primary_prop_steps[e.stepIndex],e.child_prop_steps[e.stepIndex])}))}},{key:"loadRecords",value:function(){this.dataService.LoadRecords()}},{key:"renderForm",value:function(e,t){var i={};this.formHeading="",this.primay_prop=e,this.child_prop=t,this.formHeading=t[0].toUpperCase()+t.slice(1)+" Settings","qa"===e&&(this.formHeading="[QA] "+this.formHeading),"dbsetup"===t?i={host:"",database:"",userid:"",password:""}:"dbusersetup"===t?(this.formHeading="Create Admin User",i={username:"",email:"",firstname:"",lastname:"",password:""}):i=this.Configurations[e][t],this.controls=this.formService.getControls(i,e,t,!0)}},{key:"SubmitForm",value:function(e){var t=this,i=e;if("dbsetup"!==this.child_prop&&"dbusersetup"!==this.child_prop)for(var n in i)for(var s in e)s===n&&(i[n]=e[s]);this.showProcessing=!0,this.dataService.UpdateConfigurations(i,this.primay_prop,this.child_prop).subscribe((function(e){t.coreActions.Notify("error"===e.status?{title:e.message,text:"",css:"bg-success"}:{title:"Settings Updated",text:"",css:"bg-success"}),t.showProcessing=!1,1===t.SetupType?t._nextForm():t.finalstep=!0}),(function(e){t.coreActions.Notify({title:"Error Occured",text:"",css:"bg-danger"}),t.showProcessing=!1}))}},{key:"SkipForm",value:function(e){this._nextForm()}},{key:"_nextForm",value:function(){this.stepIndex<this.child_prop_steps.length-1?(this.stepIndex++,this.renderForm(this.primary_prop_steps[this.stepIndex],this.child_prop_steps[this.stepIndex])):(this.finalstep=!0,this.dataService.SetupCompleted())}}]),e}()).\u0275fac=function(e){return new(e||P)(a.Mb(u.a),a.Mb(l.a),a.Mb(b.a),a.Mb(d.a),a.Mb(f.a),a.Mb(h.a))},P.\u0275cmp=a.Gb({type:P,selectors:[["app-setup"]],inputs:{SetupType:"SetupType"},decls:9,vars:6,consts:[[1,"container","setup-container"],[1,"row","justify-content-md-center"],[1,"col-md-8","col-sm-12"],[1,"card"],[1,"card-body"],[4,"ngIf"],[1,"m-b-20","text-center"],["class","m-b-0 m-l-10",4,"ngIf"],[1,"m-b-20"],[1,"red"],[1,"m-b-0","m-l-10"],[1,"m-b-20","m-t-0"],[3,"controls","showCancel","skipBtnText","showModal","submitText","OnSubmit","OnSkip",4,"ngIf"],[3,"controls","showCancel","skipBtnText","showModal","submitText","OnSubmit","OnSkip"],[1,"m-t-20","m-b-5"],[1,"m-t-20","m-b-20"]],template:function(e,t){1&e&&(a.Sb(0,"div",0),a.Sb(1,"div",1),a.Sb(2,"div",2),a.Sb(3,"div",3),a.Sb(4,"div",4),a.Ec(5,S,1,0,"app-loader",5),a.hc(6,"async"),a.Ec(7,I,13,5,"div",5),a.hc(8,"async"),a.Rb(),a.Rb(),a.Rb(),a.Rb(),a.Rb()),2&e&&(a.zb(5),a.nc("ngIf",a.ic(6,2,t.loading$)),a.zb(2),a.nc("ngIf",!a.ic(8,4,t.loading$)))},directives:[n.o,g.a,m.a],pipes:[n.b],encapsulation:2}),Object(c.a)([Object(p.e)(["configurations","configurations"])],P.prototype,"Configurations$",void 0),Object(c.a)([Object(p.e)(["configurations","loading"])],P.prototype,"loading$",void 0),Object(c.a)([Object(p.e)(["configurations","isloaded"])],P.prototype,"isloaded$",void 0),P),G=((O=function e(t){_classCallCheck(this,e),this.config=t,this.SetupType=0,this.SetupType=parseInt(this.config.getGlobalVar("setuptype"),10)}).\u0275fac=function(e){return new(e||O)(a.Mb(r.a))},O.\u0275cmp=a.Gb({type:O,selectors:[["ng-component"]],decls:1,vars:1,consts:[[3,"SetupType"]],template:function(e,t){1&e&&a.Nb(0,"app-setup",0),2&e&&a.nc("SetupType",t.SetupType)},directives:[z],encapsulation:2}),O),j=i("o+qO"),M=((E=function e(){_classCallCheck(this,e)}).\u0275mod=a.Kb({type:E}),E.\u0275inj=a.Jb({factory:function(e){return new(e||E)},providers:[u.a,l.a,h.a,f.a,b.a,d.a],imports:[[n.c,j.a,o.f,s.i,s.u]]}),E);i.d(t,"SetupModule",(function(){return H}));var F,N=[{path:"",data:{title:"Setup Application",urls:[{title:"Setup Application"}]},component:G}],H=((F=function e(){_classCallCheck(this,e)}).\u0275mod=a.Kb({type:F}),F.\u0275inj=a.Jb({factory:function(e){return new(e||F)},imports:[[s.i,n.c,j.a,o.f.forChild(N),M]]}),F)}}]);